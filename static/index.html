<!DOCTYPE html>
<html lang="ja">


<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="stylesheet" href="./style.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css">

<title>WebSocketTest</title>

<body>
    <div class="container block">
        <button onclick="loginpage">chatroom</button>
        <button onclick="mainpage">chatroom</button>
        <button onclick="profile">profile</button>

        <div id="login-page"></div>
        <div id="main-page" class="hidden"></div>

        <div class=loginbox>
            ID：<input type=text id=inp_ID><br>
            password：<input type=text id=inp_pass>
            <button id="login">login</button>
        </div>

  </div>
  <script type="module" src="./js/index.js"></script>
  <script type=module>
    import {hash} from "https://js.sabae.cc/hash.js";
    import {fetchJSON} from "https://js.sabae.cc/fetchJSON.js";
    
    login.onclick=async()=>{
        const item = {
            ID: inp_ID.value.trim(),
            pass: hash(inp_pass.value)
        };
        console.log("item :",item);
        const res=await fetchJSON("api/login",item);
        console.log("res :",res);
        if (!res || res=="not found"){
            alert("ユーザー登録またはログインに失敗しました");
            return;
        }
        alert("ログインに成功しました。");
        console.log(res)
    }
  </script>
</body>

</html>
